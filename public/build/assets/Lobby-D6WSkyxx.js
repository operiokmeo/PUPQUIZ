import{r as s,q as C,b as L,j as e,B as O,a as u}from"./app-DfPUS0g-.js";import{B as R}from"./button-DbBkCaNi.js";import{S as h}from"./sweetalert2.esm.all-ePrzfkxH.js";import{A as Q}from"./AuthenticatedLayout-DP1sGqdd.js";import{L as D}from"./LeaderboardModal-CVMuaNjl.js";import{T as E}from"./trophy-BsZFG-ms.js";import{C as F}from"./clock-CAzn1UTl.js";import{U as G}from"./users-BRRso5wM.js";import{U as H}from"./user-D7jZvcVM.js";import{c as W}from"./createLucideIcon-BW7jgRi7.js";import{S as J}from"./star-C0jwK31X.js";import"./index-33bLDdrw.js";import"./clsx-B-dksMZM.js";import"./utils-CP3_-lCt.js";import"./transition-CdeAVsF6.js";import"./render-TPd2KTBo.js";import"./x-B5Ef5myS.js";/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],K=W("circle-user-round",Y),je=()=>{var k,$;const[V,X]=s.useState(!1),{id:l,subject:_,subject_id:c,team_id:x,show_leaderboard_report_btn:p}=C().props,{auth:d}=C().props,[m,A]=s.useState([]),[Z,ee]=s.useState(null),[re,te]=s.useState(!1),[f,b]=s.useState(!1),[v,B]=s.useState(null),[M,j]=s.useState(null),[U,q]=s.useState([]),[z,w]=s.useState(!1);s.useEffect(()=>(window.Echo.channel("quiz-room_"+l).listen("QuizEvent",t=>{B(t.state)}),()=>{window.Echo.leave("quiz-room")}),[]);const N=async()=>{try{const r=await u.get(`/teams/${l}/${c}`);A(r.data)}catch{}};s.useRef(null);const P=async()=>{b(!0);try{await u.get(`/clear-prev-data/${l}/${c}`),(await u.get(`/lobby-start/${l}`)).data==1&&L.get(`/questionnaire/${l}/${x}/${c}`)}catch{}finally{b(!1)}};s.useEffect(()=>{v=="start-quiz"&&!d.user&&L.get(`/questionnaire/${l}/${x}/${c}`)},[v]),s.useEffect(()=>{N();const r=setInterval(()=>{N()},5e3);return()=>clearInterval(r)},[]);const T=async()=>{try{const r=await u.get(`/leaderboard/${l}/${c}`);q(r.data),w(!0)}catch{}},[y,S]=s.useState(!1),I=async()=>{var r;S(!0);try{const t=await u.get(`/report/teams/excel/${l}/${c}`,{responseType:"blob"});if(t.status===200){let n="teams_report.xlsx";const a=t.headers["content-disposition"];if(a){const g=a.match(/filename="?([^"]+)"?/);g&&g[1]&&(n=g[1])}const i=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=i,o.setAttribute("download",n),document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(i),h.fire({toast:!0,position:"top-end",icon:"success",title:"Report downloaded successfully!",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,background:"#fff",color:"#399918",iconColor:"#399918"})}else h.fire({toast:!0,position:"top-end",icon:"error",title:`Download failed: ${t.status}`,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,background:"#fff",color:"#dc3545",iconColor:"#dc3545"})}catch(t){console.error("Error during report download:",t);let n="An error occurred during download.";t.response?n=((r=t.response.data)==null?void 0:r.message)||`Server error: ${t.response.status}`:t.request?n="No response from server. Please check your connection.":n=t.message||"An unexpected error occurred.",h.fire({toast:!0,position:"top-end",icon:"error",title:n,showConfirmButton:!1,timer:4e3,timerProgressBar:!0,background:"#fff",color:"#dc3545",iconColor:"#dc3545"})}finally{S(!1)}};return e.jsxs(Q,{children:[e.jsx(O,{title:"Event Rooms Lobby"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-amber-50 to-orange-100 py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"relative bg-white/90 backdrop-blur-md rounded-2xl shadow-xl border border-orange-100 p-8 mb-8 text-center overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/5 via-transparent to-orange-500/5"}),e.jsx("div",{className:"absolute top-4 right-4 w-32 h-32 bg-gradient-to-br from-orange-200/30 to-orange-300/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-4 left-4 w-24 h-24 bg-gradient-to-br from-orange-200/20 to-orange-300/30 rounded-full blur-2xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-orange-500 to-orange-600 rounded-2xl mb-6 shadow-lg shadow-orange-200/50",children:e.jsx(E,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-5xl font-bold text-orange-600 mb-4 uppercase tracking-tight",children:_.subject_name}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-orange-500",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Ready to begin"})]})]})]}),m.length<1&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-200 rounded-2xl p-6 shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700 mb-3",children:"No Active Participant Yet"}),e.jsx("div",{className:"w-12 h-12 border-4 border-orange-300 border-t-orange-600 rounded-full animate-spin mx-auto"})]})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:m==null?void 0:m.map((r,t)=>{const n=M===t;let a=[];try{r.members&&typeof r.members=="string"?a=JSON.parse(r.members):Array.isArray(r.members)&&(a=r.members)}catch(i){console.error("Error parsing team members:",i),a=[]}return e.jsxs("div",{className:`group relative bg-white/90 backdrop-blur-lg rounded-2xl shadow-lg hover:shadow-2xl border border-orange-100 overflow-hidden transition-all duration-500 ${n?"scale-105 -translate-y-3 shadow-orange-200/50":"hover:scale-[1.02]"}`,onMouseEnter:()=>j(t),onMouseLeave:()=>j(null),children:[e.jsx("div",{className:"h-1 bg-gradient-to-r from-orange-400 via-orange-500 to-orange-600"}),e.jsx("div",{className:"absolute -top-8 -right-8 w-32 h-32 bg-gradient-to-br from-orange-200/20 to-orange-400/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 shadow-lg shadow-orange-200/40 group-hover:shadow-xl group-hover:shadow-orange-200/60 transition-all duration-300",children:e.jsx(G,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-900 group-hover:text-orange-800 transition-colors duration-300",children:r.team}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-orange-600 font-medium",children:[e.jsx(H,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.length," members"]})]})]})]}),e.jsxs("div",{className:"flex-1 pl-3 flex items-center  gap-x-2",children:[e.jsx(K,{className:"text-orange-800 w-8 h-8"}),e.jsx("h3",{className:"text-md font-bold text-orange-900 group-hover:text-orange-800 transition-colors duration-300",children:r.team_leader||"N/A"})]}),e.jsx("div",{className:"space-y-3",children:a.map((i,o)=>e.jsxs("div",{className:"group/member flex items-center gap-3 p-3 rounded-xl hover:bg-orange-50/60 transition-all duration-300 cursor-pointer",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-orange-400 to-orange-500 flex items-center justify-center shadow-md group-hover/member:shadow-lg transition-shadow duration-300",children:e.jsx("span",{className:"text-white text-sm font-bold",children:i.name?i.name.split(" ").map(g=>g[0]).join("").slice(0,2):"??"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"font-medium text-orange-800 group-hover/member:text-orange-900 transition-colors duration-300 truncate",children:i.name||"Unknown Member"})}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400 group-hover/member:bg-orange-500 transition-colors duration-300"})]},o))}),e.jsx("div",{className:"mt-6 pt-4 border-t border-orange-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Team Ready"})]}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(a.length)].map((i,o)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-all duration-300 ${o<Math.min(a.length,a.length)?"bg-orange-400":"bg-orange-200"}`},o))})]})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-orange-500/5 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"})]},t)})}),!d.user&&e.jsxs("div",{className:"text-center bg-white/90 backdrop-blur-md rounded-2xl p-6 shadow-lg border border-orange-100 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-orange-600 font-medium",children:"Waiting for the Quiz Master to start..."})]}),e.jsx("div",{className:"w-full bg-orange-100 rounded-full h-1 mt-4",children:e.jsx("div",{className:"bg-orange-500 h-1 rounded-full animate-pulse",style:{width:"60%"}})})]}),p==0&&(((k=d==null?void 0:d.user)==null?void 0:k.role)==1||(($=d==null?void 0:d.user)==null?void 0:$.role)==3)&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("button",{onClick:P,disabled:f||m.length<1,className:"group relative bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 disabled:from-orange-400 disabled:to-orange-500 text-white px-12 py-4 rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl shadow-orange-200/50 hover:shadow-orange-300/60 transform hover:scale-[1.02] active:scale-95 transition-all duration-300 disabled:cursor-not-allowed disabled:transform-none",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-400 to-orange-500 rounded-2xl blur-lg opacity-30 group-hover:opacity-50 transition-opacity duration-300"}),e.jsx("div",{className:"relative flex items-center gap-3",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Starting Please Wait..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Proceed to Quiz"})]})})]})}),p==1&&e.jsxs("div",{className:"flex justify-center space-x-10 mt-5",children:[e.jsx("div",{className:"flex justify-center mt-10",children:e.jsx(R,{onClick:()=>T(),className:"bg-transparent text-1xl p-5 text-orange-700 hover:bg-orange-600 hover:text-white",children:"Show Leaderboard"})}),e.jsx("div",{className:"flex justify-center mt-10",children:e.jsx(R,{disabled:y,onClick:r=>{r.preventDefault(),r.stopPropagation(),I()},className:"bg-transparent text-1xl p-5 text-orange-700 hover:bg-orange-600 hover:text-white cursor-pointer",type:"button",children:y?" Downloading ...":" Generate Report"})})]}),e.jsx(D,{isOpen:z,onClose:()=>w(!1),leaderboard:U,team_id:1,state:"over-all-leaderboard",currentQuestion:{points:10}})]})})]})};export{je as default};
