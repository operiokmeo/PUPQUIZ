import{q as w,r as p,j as e,b as S,R as _,a as A}from"./app-DfPUS0g-.js";import{A as k}from"./AuthenticatedLayout-DP1sGqdd.js";import{B as g}from"./button-DbBkCaNi.js";import{S as l}from"./sweetalert2.esm.all-ePrzfkxH.js";import{L as q}from"./layout-dashboard-CJdz84ez.js";import{S as y}from"./search-B22_l6qK.js";import{U as R}from"./user-D7jZvcVM.js";import{H as E,B as L}from"./hash-CIAl1wSh.js";import{U as N}from"./users-BRRso5wM.js";import{C as B}from"./chevron-up-Dt5whIsJ.js";import{C as M}from"./chevron-down--lttUmvU.js";import{E as D}from"./eye-CDZT0WGR.js";import{c as T}from"./createLucideIcon-BW7jgRi7.js";import"./transition-CdeAVsF6.js";import"./render-TPd2KTBo.js";import"./index-33bLDdrw.js";import"./clsx-B-dksMZM.js";import"./utils-CP3_-lCt.js";/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],V=T("file-check-2",I);function le({}){const{lobby:u,pre_registration:v}=w().props,f=v,{auth:P}=w().props,[c,C]=p.useState(""),[d,U]=p.useState("all"),[b,F]=p.useState(new Set),x=f.filter(t=>{const n=t.team.trim().toLowerCase().includes(c.trim().toLowerCase())||t.team_leader.trim().toLowerCase().includes(c.trim().toLowerCase());return d==="all"?n:d==="active"?n&&!t.logout_timestamp:d==="ended"?n&&t.logout_timestamp:n}),j=async(t,n)=>{var r,i,a,h;const{value:o}=await l.fire({title:`${t} Participant`,input:"textarea",inputLabel:"Enter your comment (optional)",inputPlaceholder:"Write your comment here...",inputAttributes:{"aria-label":"Write your comment here"},showCancelButton:!0,confirmButtonText:`Yes, ${t}`,cancelButtonText:"Cancel",icon:t==="Reject"?"warning":"question",confirmButtonColor:t==="Reject"?"#d33":"#3085d6"});if(o===void 0)return;const s=new FormData;s.append("lobby_id",u.id),s.append("status",t==="Reject"?"1":"2"),s.append("participant_id",n),s.append("comment",o||"");try{l.fire({title:"Please wait...",text:`${t=="Approved"?"Approv":t}ing participant...`,allowOutsideClick:!1,didOpen:()=>{l.showLoading()}});const m=await A.post("/manage-pre-registration",s);l.close(),m.data.success?((r=document.getElementById(`pre-reg-${n}`))==null||r.remove(),await l.fire({icon:"success",title:"Success!",text:m.data.message,confirmButtonColor:"#3085d6"})):await l.fire({icon:"error",title:"Error",text:m.data.message||"Something went wrong."})}catch(m){l.close(),console.error(((i=m.response)==null?void 0:i.data)||m.message),await l.fire({icon:"error",title:"Request Failed",text:((h=(a=m.response)==null?void 0:a.data)==null?void 0:h.message)||"Unable to process the request."})}},$=t=>{if(!t||t.length===0){l.fire({icon:"info",title:"No Files",text:"No files available to view",confirmButtonColor:"#16a34a"});return}const n=t.reduce((s,r)=>{const i=r.name.match(/\((.*?)\)/),a=i?i[1]:"Unknown";return s[a]||(s[a]=[]),s[a].push(r),s},{}),o=Object.entries(n).map(([s,r])=>{const i=r.map((a,h)=>a.type==="pdf"||a.url.toLowerCase().endsWith(".pdf")?`
        <div class="w-1/3 p-2 text-center">
          <h4 class="font-semibold text-gray-700 mb-2">${a.name.replace(/\s*\(.*?\)\s*/,"")}</h4>
          <iframe 
            src="${a.url}" 
            width="100%" 
            height="300px" 
            style="border: 1px solid #ddd; border-radius: 8px;"
          ></iframe>
          <a href="${a.url}" target="_blank" class="inline-block mt-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition">
            Open in New Tab
          </a>
        </div>
      `:a.type==="image"||/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(a.url)?`
        <div class="w-1/3 p-2 text-center">
          <h4 class="font-semibold text-gray-700 mb-2">${a.name.replace(/\s*\(.*?\)\s*/,"")}</h4>
          <img 
            src="${a.url}" 
            alt="${a.name}" 
            style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"
          />
          <a href="${a.url}" target="_blank" class="inline-block mt-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition">
            View Full Size
          </a>
        </div>
      `:`
        <div class="w-1/3 p-2 text-center">
          <h4 class="font-semibold text-gray-700 mb-2">${a.name.replace(/\s*\(.*?\)\s*/,"")}</h4>
          <p class="text-gray-600 mb-2">File type not supported for preview</p>
          <a href="${a.url}" target="_blank" class="inline-block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition">
            Download File
          </a>
        </div>
      `).join("");return`
    <div class="mb-8 pb-4 border-b">
      <h3 class="text-xl font-bold text-gray-800 mb-4">${s}</h3>
      <div class="flex flex-wrap -m-2">
        ${i}
      </div>
    </div>
  `}).join("");l.fire({title:"View Files",html:`
            <div style="max-height: 600px; overflow-y: auto; text-align: left;">
                ${o}
            </div>
        `,width:"80%",showCloseButton:!0,showConfirmButton:!1,customClass:{popup:"swal-wide",htmlContainer:"swal-html-container"}})};return e.jsx("div",{children:e.jsx(k,{children:e.jsx("div",{className:"min-h-screen bg-white p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2 bg-gradient-to-r from-red-600 to-amber-600 bg-clip-text text-transparent",children:u.name}),e.jsx("p",{className:"text-gray-600",children:"Manage Pre Registration"})]}),e.jsxs("div",{onClick:()=>S.get("/organizerLobby"),className:"bg-red-500 text-white p-4 flex gap-x-3 rounded-md hover:bg-red-700 hover:cursor-pointer",children:[e.jsx(q,{}),e.jsx("p",{children:"Go to Dashboard"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by team name or team leader name...",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",value:c,onChange:t=>C(t.target.value)})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-red-500 to-amber-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Team Name"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Team Leader"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Email"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"Contact Number"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"Members"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"View Preview"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map((t,n)=>{const o=b.has(t.id);let s=[];if(t.members)try{s=typeof t.members=="string"?JSON.parse(t.members):t.members,Array.isArray(s)||(s=[])}catch(r){console.error("Error parsing members:",r),s=[]}return e.jsxs(_.Fragment,{children:[e.jsxs("tr",{id:`pre-reg-${t.id}`,className:`hover:bg-red-50 transition-colors duration-200 ${n%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-fit px-8 truncate h-8 bg-gradient-to-r from-red-400 to-amber-400 rounded-full flex items-center justify-center text-white font-semibold text-sm mr-3",children:t.team})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center w-fit truncate",children:[e.jsx(R,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-900 font-medium uppercase",children:t.team_leader||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-900",children:t.team_leader_email||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-900 font-mono",children:t.contact_number||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[s.length," ",s.length===1?"Member":"Members"]}),s.length>0&&e.jsx("button",{onClick:()=>{const r=new Set(b);o?r.delete(t.id):r.add(t.id),F(r)},className:"ml-2 text-red-600 hover:text-red-800",children:o?e.jsx(B,{className:"w-4 h-4"}):e.jsx(M,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs(g,{size:"sm",className:"bg-green-600 hover:bg-green-800",onClick:()=>{try{const r=[];if(t.student_id&&r.push({url:"/storage/"+t.student_id,type:"image",name:`Valid Student ID - Team Leader (${t.team_leader||"N/A"})`}),t.registration_form&&r.push({url:"/storage/"+t.registration_form,type:"image",name:`Registration Form - Team Leader (${t.team_leader||"N/A"})`}),t.consent_form&&r.push({url:"/storage/"+t.consent_form,type:"image",name:`Consent Form - Team Leader (${t.team_leader||"N/A"})`}),t.members){let i;try{i=typeof t.members=="string"?JSON.parse(t.members):t.members}catch(a){console.error("Error parsing members:",a),i=[]}Array.isArray(i)&&i.forEach(a=>{a.requirements&&(a.requirements.studentId&&r.push({url:"/storage/"+a.requirements.studentId,type:"image",name:`Valid Student ID - ${a.name||"Member"}`}),a.requirements.registrationForm&&r.push({url:"/storage/"+a.requirements.registrationForm,type:"image",name:`Registration Form - ${a.name||"Member"}`}),a.requirements.consentForm&&r.push({url:"/storage/"+a.requirements.consentForm,type:"image",name:`Consent Form - ${a.name||"Member"}`}))})}if(r.length===0){l.fire({icon:"info",title:"No Files",text:"No files available to view",confirmButtonColor:"#16a34a"});return}$(r)}catch(r){console.error("Error viewing files:",r),l.fire({icon:"error",title:"Error",text:"Failed to load files. Please try again.",confirmButtonColor:"#dc2626"})}},children:[e.jsx(D,{className:"w-4 h-4 text-white"}),e.jsx("span",{children:"View"})]})}),e.jsxs("td",{className:"px-6 py-4 text-center flex justify-between",children:[e.jsxs(g,{size:"sm",className:"bg-blue-600 hover:bg-blue-800",onClick:()=>j("Approved",t.id),children:[e.jsx(V,{className:"w-4 h-4 text-white "}),e.jsx("span",{children:"Approved"})]}),e.jsxs(g,{size:"sm",className:"bg-red-600 hover:bg-red-800",onClick:()=>j("Reject",t.id),children:[e.jsx(L,{className:"w-4 h-4 text-white "}),e.jsx("span",{children:"Reject"})]})]})]}),o&&s.length>0&&e.jsx("tr",{className:`${n%2===0?"bg-gray-50":"bg-white"}`,children:e.jsx("td",{colSpan:7,className:"px-6 py-4",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-red-600"}),"Team Members Information"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map((r,i)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:r.name||`Member ${i+1}`}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Student Number:"})," ",r.studentNumber||"N/A"]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Course/Year:"})," ",r.courseYear||"N/A"]}),r.requirements&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Requirements:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsxs("li",{className:r.requirements.studentId?"text-green-600":"text-gray-400",children:[r.requirements.studentId?"✓":"✗"," Student ID"]}),e.jsxs("li",{className:r.requirements.registrationForm?"text-green-600":"text-gray-400",children:[r.requirements.registrationForm?"✓":"✗"," Registration Form"]}),e.jsxs("li",{className:r.requirements.consentForm?"text-green-600":"text-gray-400",children:[r.requirements.consentForm?"✓":"✗"," Consent Form"]})]})]})]})]},i))})]})})})]},t.id)})})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(y,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or filters."})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:["Showing ",x.length," of ",f.length," Registration"]})})]})})})})}export{le as default};
